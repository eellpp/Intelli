<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>R Data Structure Common Operations</title>
  <meta name="description" content="The common data structure in R are Vectors, List, Array, Matrix and Dataframe.">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://localhost:4000/2014/10/23/r-data-structure-common-operations.html">
  <link rel="alternate" type="application/rss+xml" title="IntelliSignals" href="http://localhost:4000/feed.xml">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">
    <div class="site-title">
	<a href="/" style="font-size: 42px;">IntelliSignals</a>
	<h2 style="display: inline;font-size: 16px;margin-bottom: 0px;">BigData, Analytics and Cloud</h2>
     </div>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
	  
	  
		  
		  <a class="page-link" href="/about/">About</a>
		  
	  
        
	  
	  
		  
		  <a class="page-link" href="/archive/">Archive</a>
		  
	  
        
	  
	  
		  
	  
        
	  
	  
		  
	  
        
	  
	  
		  
	  
        
	  
	  
		  
	  
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">R Data Structure Common Operations</h1>
    <p class="post-meta">
	<time datetime="2014-10-23T02:00:00+08:00" itemprop="datePublished">Oct 23, 2014
 	</time>
	
		

		
		|
		<a href="
			http://localhost:4000
		/tag/R/" >R</a>
		
		<a href="
			http://localhost:4000
		/tag/analytics/" >analytics</a>
		 
		
	
    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>The common data structure in R are 
Vectors, List, Array, Matrix and Dataframe.</p>

<p>###Vector Operations</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># values from 1 :5</span>
vec &lt;- c<span class="o">(</span>1:5<span class="o">)</span>
vec &lt;- c<span class="o">(</span>sample<span class="o">(</span>5<span class="o">))</span>
vec &lt;- rnorm<span class="o">(</span>5,mean<span class="o">=</span>2.5,sd<span class="o">=</span>2<span class="o">)</span>
vec &lt;- c<span class="o">(</span>letters[1:5]<span class="o">)</span>
vec_name &lt;-  c<span class="o">(</span><span class="s2">"id"</span> <span class="o">=</span> 1, <span class="s2">"age"</span> <span class="o">=</span> 21<span class="o">)</span>
vec_name &lt;-  c<span class="o">(</span><span class="s2">"id"</span> <span class="o">=</span> 1:5, <span class="s2">"age"</span> <span class="o">=</span> 21:25<span class="o">)</span>
 id1  id2  id3  id4  id5 age1 age2 age3 age4 age5 
  1    2    3    4    5   21   22   23   24   25 

<span class="c"># check whether value exists in vector</span>
2 %in% vec
<span class="c">#filtering on multiple conditions </span>
l &lt;- sample<span class="o">(</span>c<span class="o">(</span>1:50<span class="o">)</span>,10<span class="o">)</span>
d &lt;- sample<span class="o">(</span>c<span class="o">(</span>1:50<span class="o">)</span>,10<span class="o">)</span>
l[l %in% d | l <span class="o">&gt;</span> 40]
<span class="c"># find the index of the value in vector</span>
match<span class="o">(</span>3,vec<span class="o">)</span>

Selecting elements
<span class="c"># select element 1 and 3</span>
vec[c<span class="o">(</span>1,3<span class="o">)]</span>
<span class="c"># filter out element 1 and 3</span>
vec[-c<span class="o">(</span>1,3<span class="o">)]</span>
<span class="c"># filter out elements based on logical true or false</span>
vec[sample<span class="o">(</span>rep<span class="o">(</span>c<span class="o">(</span>TRUE,FALSE<span class="o">)</span>,2<span class="o">)</span>, 2<span class="o">)]</span>
<span class="c"># filter out </span>
vec[vec <span class="o">&gt;</span>3]

<span class="c"># change the value of some elements</span>
vec[c<span class="o">(</span>1,4<span class="o">)]</span> &lt;- c<span class="o">(</span>10,14<span class="o">)</span>
vec[-c<span class="o">(</span>2,3,5<span class="o">)]</span> &lt;- c<span class="o">(</span>10,14<span class="o">)</span></code></pre></figure>

<h3 id="list">List</h3>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">List is a collection of different objects
list<span class="o">(</span> c<span class="o">(</span>1:5<span class="o">)</span>, letters[1:5] <span class="o">)</span></code></pre></figure>

<h3 id="array-and-matrices">Array and Matrices</h3>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">mat &lt;- matrix<span class="o">(</span>1:4,nrow <span class="o">=</span> 2, ncol <span class="o">=</span> 2<span class="o">)</span>
arr &lt;- array<span class="o">(</span>1:6,dim<span class="o">=</span>c<span class="o">(</span>2,3<span class="o">))</span></code></pre></figure>

<h3 id="data-frames">Data frames</h3>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#By default the strings columns are considered as factors. You can turn it to false</span>
data.frame<span class="o">(</span>id <span class="o">=</span> 1:10, category <span class="o">=</span> letters[1:10],stringsAsFactors <span class="o">=</span> FALSE<span class="o">)</span>
<span class="o">&gt;</span> str<span class="o">(</span>df<span class="o">)</span>
<span class="s1">'data.frame'</span>:	10 obs. of  2 variables:
 <span class="nv">$ </span>id      : int  1 2 3 4 5 6 7 8 9 10
 <span class="nv">$ </span>category: chr  <span class="s2">"a"</span> <span class="s2">"b"</span> <span class="s2">"c"</span> <span class="s2">"d"</span> ...</code></pre></figure>

<p>Since data frame is both a list and rectangular structure you can access the values in two ways</p>

<ul>
  <li>You can use the list operators: df[i], df[[i]] , df$col</li>
  <li>You can use the matrix notation: df[i, j] df[i , ] df[ , j]</li>
</ul>

<h4 id="dataframe-vs-asdataframe">Data.frame vs as.data.frame</h4>
<p>If your data is captured in several vectors and/or factors, use the data.frame function to assemble them into a data frame:</p>
<blockquote>
  <p>df &lt;- data.frame(v1, v2, v3, f1, f2)</p>
</blockquote>

<p>If your data is captured in a list that contains vectors and/or factors, use instead
as.data.frame:</p>
<blockquote>
  <p>dfrm &lt;- as.data.frame(list.of.vectors) 
data.frame calls as.data.frame internally</p>
</blockquote>

<h4 id="operations-on-dataframe">Operations on Dataframe</h4>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#Adding a column</span>
cbind<span class="o">(</span>df, data.frame<span class="o">(</span> cat_id <span class="o">=</span> paste<span class="o">(</span>6,<span class="s2">"_"</span>,letters[6], <span class="nv">sep</span><span class="o">=</span><span class="s2">""</span><span class="o">)))</span>

<span class="c">#Adding a row</span>
rbind<span class="o">(</span>df,data.frame<span class="o">(</span>id <span class="o">=</span> 6, category <span class="o">=</span> letters[6]<span class="o">))</span>

Check out the structure of data frame 
str<span class="o">(</span>mtcars<span class="o">)</span>

<span class="c"># add a column with some NA value</span>
mtcars_df &lt;- cbind<span class="o">(</span>mtcars, data.frame<span class="o">(</span> <span class="s2">"temp"</span> <span class="o">=</span> sample<span class="o">(</span>rep<span class="o">(</span>c<span class="o">(</span><span class="s2">"a"</span>,<span class="s2">"b"</span>,NA,<span class="s2">"c"</span><span class="o">)</span>,8<span class="o">)</span>,32<span class="o">)</span>  <span class="o">))</span></code></pre></figure>

<h4 id="subsetting-dataframe">Subsetting dataframe</h4>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># get rows 1:5</span>
mtcars[c<span class="o">(</span>1:5<span class="o">)</span> ,]

<span class="c"># filter out the rows for which the temp column is NA</span>
mtcars_df[ is.na<span class="o">(</span>mtcars_df<span class="nv">$temp</span><span class="o">)</span> <span class="o">==</span> FALSE ,]

<span class="c">#In the dataset lets find the rows where the carb column is 1 or 2</span>
mtcars[mtcars<span class="nv">$carb</span> %in% c<span class="o">(</span>1,2<span class="o">)</span>  ,]
subset<span class="o">(</span>mtcars, carb %in% c<span class="o">(</span>1,2<span class="o">)</span> <span class="o">)</span>
mtcars[!is.na<span class="o">(</span>match<span class="o">(</span>mtcars<span class="nv">$carb</span>,c<span class="o">(</span>1,2<span class="o">)</span>   <span class="o">))</span>,]

<span class="c">#There are various ways of doing subsetting operations. But the important thing is to know the tricks of using the operators so that when the need arises you can intelligently combine them.</span>

<span class="c">#To group dataframe by factor levels</span>
df &lt;- Toothgrowth
split<span class="o">(</span>df,levels<span class="o">(</span>df<span class="nv">$supp</span><span class="o">))</span> <span class="c"># this will give the lists of dataframes, one for each factor level</span>
split<span class="o">(</span>mtcars,mtcars<span class="nv">$gear</span><span class="o">)</span>

<span class="c">#To run a function under each of the split group</span>
<span class="c"># get average mpg for different gear levels</span>
 by<span class="o">(</span>mtcars,mtcars<span class="nv">$gear</span>,FUN <span class="o">=</span> <span class="k">function</span><span class="o">(</span>df<span class="o">){</span> mean<span class="o">(</span>df<span class="nv">$mpg</span><span class="o">)})</span>
mtcars<span class="nv">$gear</span>: 3
<span class="o">[</span>1] 16.10667
mtcars<span class="nv">$gear</span>: 4
<span class="o">[</span>1] 24.53333
mtcars<span class="nv">$gear</span>: 5
<span class="o">[</span>1] 21.38


<span class="c">#Show the freq table for two different columns of a dataframe</span>
f &lt;- mtcars
f<span class="nv">$cyl</span> <span class="o">=</span> as.factor<span class="o">(</span>f<span class="nv">$cyl</span><span class="o">)</span>
f<span class="nv">$gear</span> <span class="o">=</span> as.factor<span class="o">(</span>f<span class="nv">$gear</span><span class="o">)</span>
table<span class="o">(</span>f<span class="nv">$cyl</span>,f<span class="nv">$gear</span><span class="o">)</span>
   
     3  4  5
  4  1  8  2
  6  2  4  1
  8 12  0  2</code></pre></figure>

<h3 id="binning-of-data">Binning of data</h3>
<p>You have a vector, and you want to split the data into groups according to intervals.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># get a weighted sample </span>
vec &lt;- sample<span class="o">(</span>c<span class="o">(</span>1:5<span class="o">)</span>,20,replace <span class="o">=</span> TRUE, prob <span class="o">=</span> c<span class="o">(</span>10,15,45,25,5<span class="o">))</span>
<span class="c"># create the group ranges</span>
breaks &lt;- c<span class="o">(</span>0,2,3,4,6<span class="o">)</span>
groups &lt;- cut<span class="o">(</span>vec,breaks,c<span class="o">(</span><span class="s2">"0-2"</span>,<span class="s2">"2-3"</span>,<span class="s2">"3-4"</span>,<span class="s2">"4-6"</span><span class="o">))</span>
<span class="o">&gt;</span> table<span class="o">(</span>groups<span class="o">)</span>
groups
0-2 2-3 3-4 4-6 
  4   5  10   1 </code></pre></figure>

<h3 id="operations-on-model-object">Operations on model object</h3>
<p>Given an model we can update it with new features</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># add additional feature z to existing model m</span>
update<span class="o">(</span>m , ~ <span class="nb">.</span> + z<span class="o">)</span> 
<span class="c">#Where . means  "what was previously in this part of the formula".</span>

<span class="c"># update the model by adding new observations in the dataframe df</span>
update<span class="o">(</span>m1, <span class="nb">.</span> ~ ., data <span class="o">=</span> df<span class="o">)</span>

<span class="c">#remove a field from model</span>
update<span class="o">(</span>m1,as.formula<span class="o">(</span>paste<span class="o">(</span><span class="s2">".~.-"</span>, fieldRemove<span class="o">))</span> <span class="o">)</span></code></pre></figure>


  </div>

</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">


    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>IntelliSignals</li>
          <li><a href="mailto:contact@intellisignals.com">contact@intellisignals.com</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          

          
        </ul>
      </div>

    </div>

  </div>

</footer>


  </body>

</html>
